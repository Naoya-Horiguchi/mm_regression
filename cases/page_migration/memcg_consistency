. $TRDIR/setup_page_migration.sh

NUMA_NODE=2
HUGEPAGESIZE=2048 # kB
HUGETLB=100
EXPECTED_RETURN_CODE="START CGCLASSIFY_PASS MIGRATION_PASSED HUGEPAGE_MIGRATED EXIT"
TEST_PROGRAM="$test_alloc_generic -B hugetlb_anon -N 10 -L 'start:wait_after mmap_numa access:wait_after migratepages munmap:wait_before exit:wait_before'"
MIGRATE_SRC=migratepages

SOFT_RETRY=5

CGROUP=cpu,memory,hugetlb:test1

_prepare() {
    prepare_hugepage_migration || return 1
	cgset -r memory.move_charge_at_immigrate=1 test1
}
